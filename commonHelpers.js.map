{"version":3,"file":"commonHelpers.js","sources":["../src/index.js"],"sourcesContent":["import axios from 'axios';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '34373516-b73f95caf1f569d1c97db55cd';\n\nconst refs = {\n  formEl: document.querySelector('.search-form'),\n  galleryEl: document.querySelector('.gallery'),\n  loadMoreBtnEl: document.querySelector('.load-more'),\n};\nlet page;\nlet searchQuery;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  fadeSpeed: 500,\n  animationSlide: true,\n  widthRatio: 1,\n});\n\nrefs.formEl.addEventListener('submit', handleForm);\nrefs.loadMoreBtnEl.addEventListener('click', onLoadMoreBtnClick);\n\nfunction handleForm(e) {\n  e.preventDefault();\n  page = 1;\n  searchQuery = refs.formEl[0].value.trim();\n  if (!searchQuery) {\n    showMessage('Please enter a search query!');\n    return;\n  }\n  serviceImage(searchQuery);\n  clearForm();\n}\n\nasync function serviceImage(searchQuery) {\n  try {\n    const { data } = await fetchImage(searchQuery);\n    const { hits, totalHits } = data;\n    if (!hits.length) {\n      showMessage(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      return;\n    }\n    insertMarkUp(hits);\n    lightbox.refresh();\n    checkIsPageFirst(totalHits);\n    showLoadMoreBtn();\n    checkToReachEnd(totalHits);\n  } catch (error) {\n    showMessage(error.message, '#ffafb4');\n  }\n}\nasync function fetchImage(searchQuery) {\n  const param = new URLSearchParams({\n    key: API_KEY,\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 40,\n    page: page,\n  });\n\n  return await axios.get(`${BASE_URL}?${param}`);\n}\nfunction markUp(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `    \n      <a href=${largeImageURL}>\n        <div class=\"photo-card\">\n        <img src=${webformatURL}  alt=${tags}  loading=\"lazy\" />\n        <div class=\"info\">\n            <p class=\"info-item\">\n                <b>Likes ${likes}</b>\n            </p>\n                <p class=\"info-item\">\n            <b>Views ${views}</b>\n            </p>\n            <p class=\"info-item\">\n                <b>Comments ${comments}</b>\n            </p>\n            <p class=\"info-item\">\n                <b>Downloads ${downloads}</b>\n            </p>\n        </div>\n    </div> \n    </a>`\n    )\n    .join('');\n}\nfunction insertMarkUp(hits) {\n  refs.galleryEl.insertAdjacentHTML('beforeend', markUp(hits));\n}\nfunction showMessage(message, color = '#cef6ba') {\n  iziToast.info({\n    message: message,\n    position: 'topLeft',\n    color: color,\n    closeOnClick: true,\n    timeout: 2500,\n    pauseOnHover: true,\n  });\n}\nfunction clearForm() {\n  refs.formEl[0].value = '';\n  refs.galleryEl.innerHTML = '';\n  hideLoadMoreBtn();\n}\nfunction showLoadMoreBtn() {\n  refs.loadMoreBtnEl.style.display = 'flex';\n}\nfunction hideLoadMoreBtn() {\n  refs.loadMoreBtnEl.style.display = 'none';\n}\nfunction onLoadMoreBtnClick() {\n  page++;\n  return serviceImage(searchQuery);\n}\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\nfunction checkToReachEnd(totalHits) {\n  if (totalHits <= page * 40) {\n    hideLoadMoreBtn();\n    setTimeout(() => {\n      showMessage(\n        `We're sorry, but you've reached the end of search results...`,\n        '#ffff99'\n      );\n    }, 2000);\n  }\n}\nfunction checkIsPageFirst(totalHits) {\n  if (page === 1) {\n    showMessage(`Hooray! We found ${totalHits} images.`);\n  }\n  if (page !== 1) {\n    smoothScroll();\n  }\n}\n"],"names":["BASE_URL","API_KEY","refs","page","searchQuery","lightbox","SimpleLightbox","handleForm","onLoadMoreBtnClick","showMessage","serviceImage","clearForm","data","fetchImage","hits","totalHits","insertMarkUp","checkIsPageFirst","showLoadMoreBtn","checkToReachEnd","error","param","axios","markUp","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","message","color","iziToast","hideLoadMoreBtn","smoothScroll","cardHeight"],"mappings":"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"}