{"version":3,"file":"commonHelpers.js","sources":["../src/index.js"],"sourcesContent":["import axios from 'axios';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '34373516-b73f95caf1f569d1c97db55cd';\n\nconst refs = {\n  formEl: document.querySelector('.search-form'),\n  galleryEl: document.querySelector('.gallery'),\n  loadMoreBtnEl: document.querySelector('.load-more'),\n};\nlet page;\nlet searchQuery;\n\nrefs.formEl.addEventListener('submit', handleForm);\nrefs.loadMoreBtnEl.addEventListener('click', onLoadMoreBtnClick);\n\nfunction handleForm(e) {\n  e.preventDefault();\n  page = 1;\n  searchQuery = refs.formEl[0].value;\n  serviceImage(searchQuery);\n  clearForm();\n}\n\nfunction serviceImage(searchQuery) {\n  const param = new URLSearchParams({\n    key: API_KEY,\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 40,\n    page: page,\n  });\n\n  return axios\n    .get(`${BASE_URL}?${param}`)\n    .then(({ data }) => {\n      if (!data.hits.length) {\n        showMessage(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n        return;\n      }\n      if (page === 1) {\n        showMessage(`Hooray! We found ${data.totalHits} images.`);\n      }\n      refs.galleryEl.insertAdjacentHTML('beforeend', markUp(data.hits));\n      initLightbox();\n      showLoadMoreBtn();\n      if (page !== 1) {\n        smoothScroll();\n      }\n      if (data.totalHits <= page * 40) {\n        hideLoadMoreBtn();\n        setTimeout(() => {\n          showMessage(\n            `We're sorry, but you've reached the end of search results...`,\n            '#ffff99'\n          );\n        }, 2000);\n      }\n    })\n    .catch(error => showMessage(error.message, '#ffafb4'));\n}\nfunction markUp(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `    \n      <a href=${largeImageURL}>\n        <div class=\"photo-card\">\n        <img src=${webformatURL}  alt=${tags}  loading=\"lazy\" />\n        <div class=\"info\">\n            <p class=\"info-item\">\n                <b>Likes ${likes}</b>\n            </p>\n                <p class=\"info-item\">\n            <b>Views ${views}</b>\n            </p>\n            <p class=\"info-item\">\n                <b>Comments ${comments}</b>\n            </p>\n            <p class=\"info-item\">\n                <b>Downloads ${downloads}</b>\n            </p>\n        </div>\n    </div> \n    </a>`\n    )\n    .join('');\n}\nfunction showMessage(message, color = '#cef6ba') {\n  iziToast.info({\n    message: message,\n    position: 'topLeft',\n    color: color,\n    closeOnClick: true,\n    timeout: 2500,\n    pauseOnHover: true,\n  });\n}\nfunction clearForm() {\n  refs.formEl[0].value = '';\n  refs.galleryEl.innerHTML = '';\n  hideLoadMoreBtn();\n}\nfunction showLoadMoreBtn() {\n  refs.loadMoreBtnEl.style.display = 'flex';\n}\nfunction hideLoadMoreBtn() {\n  refs.loadMoreBtnEl.style.display = 'none';\n}\nfunction onLoadMoreBtnClick() {\n  page++;\n  return serviceImage(searchQuery);\n}\nfunction initLightbox() {\n  const lightbox = new SimpleLightbox('.gallery a', {\n    fadeSpeed: 500,\n    animationSlide: true,\n    widthRatio: 1,\n  });\n\n  refs.galleryEl.addEventListener('click', e => {\n    if (e.target.classList.contains('photo-card')) {\n      lightbox.open();\n    }\n  });\n}\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["BASE_URL","API_KEY","refs","page","searchQuery","handleForm","onLoadMoreBtnClick","e","serviceImage","clearForm","param","axios","data","showMessage","markUp","initLightbox","showLoadMoreBtn","smoothScroll","hideLoadMoreBtn","error","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","message","color","iziToast","lightbox","SimpleLightbox","cardHeight"],"mappings":"owBAOA,MAAMA,EAAW,2BACXC,EAAU,qCAEVC,EAAO,CACX,OAAQ,SAAS,cAAc,cAAc,EAC7C,UAAW,SAAS,cAAc,UAAU,EAC5C,cAAe,SAAS,cAAc,YAAY,CACpD,EACA,IAAIC,EACAC,EAEJF,EAAK,OAAO,iBAAiB,SAAUG,CAAU,EACjDH,EAAK,cAAc,iBAAiB,QAASI,CAAkB,EAE/D,SAASD,EAAWE,EAAG,CACrBA,EAAE,eAAc,EAChBJ,EAAO,EACPC,EAAcF,EAAK,OAAO,GAAG,MAC7BM,EAAaJ,CAAW,EACxBK,GACF,CAEA,SAASD,EAAaJ,EAAa,CACjC,MAAMM,EAAQ,IAAI,gBAAgB,CAChC,IAAKT,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAMD,CACV,CAAG,EAED,OAAOQ,EACJ,IAAI,GAAGX,KAAYU,GAAO,EAC1B,KAAK,CAAC,CAAE,KAAAE,KAAW,CAClB,GAAI,CAACA,EAAK,KAAK,OAAQ,CACrBC,EACE,0EACV,EACQ,MACD,CACGV,IAAS,GACXU,EAAY,oBAAoBD,EAAK,mBAAmB,EAE1DV,EAAK,UAAU,mBAAmB,YAAaY,EAAOF,EAAK,IAAI,CAAC,EAChEG,IACAC,IACIb,IAAS,GACXc,IAEEL,EAAK,WAAaT,EAAO,KAC3Be,IACA,WAAW,IAAM,CACfL,EACE,+DACA,SACZ,CACS,EAAE,GAAI,EAEf,CAAK,EACA,MAAMM,GAASN,EAAYM,EAAM,QAAS,SAAS,CAAC,CACzD,CACA,SAASL,EAAOM,EAAK,CACnB,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA,gBACIL;AAAA;AAAA,mBAEGD,UAAqBE;AAAA;AAAA;AAAA,2BAGbC;AAAA;AAAA;AAAA,uBAGJC;AAAA;AAAA;AAAA,8BAGOC;AAAA;AAAA;AAAA,+BAGCC;AAAA;AAAA;AAAA;AAAA,SAK1B,EACA,KAAK,EAAE,CACZ,CACA,SAASd,EAAYe,EAASC,EAAQ,UAAW,CAC/CC,EAAS,KAAK,CACZ,QAASF,EACT,SAAU,UACV,MAAOC,EACP,aAAc,GACd,QAAS,KACT,aAAc,EAClB,CAAG,CACH,CACA,SAASpB,GAAY,CACnBP,EAAK,OAAO,GAAG,MAAQ,GACvBA,EAAK,UAAU,UAAY,GAC3BgB,GACF,CACA,SAASF,GAAkB,CACzBd,EAAK,cAAc,MAAM,QAAU,MACrC,CACA,SAASgB,GAAkB,CACzBhB,EAAK,cAAc,MAAM,QAAU,MACrC,CACA,SAASI,GAAqB,CAC5B,OAAAH,IACOK,EAAaJ,CAAW,CACjC,CACA,SAASW,GAAe,CACtB,MAAMgB,EAAW,IAAIC,EAAe,aAAc,CAChD,UAAW,IACX,eAAgB,GAChB,WAAY,CAChB,CAAG,EAED9B,EAAK,UAAU,iBAAiB,QAASK,GAAK,CACxCA,EAAE,OAAO,UAAU,SAAS,YAAY,GAC1CwB,EAAS,KAAI,CAEnB,CAAG,CACH,CACA,SAASd,GAAe,CACtB,KAAM,CAAE,OAAQgB,CAAU,EAAK,SAC5B,cAAc,UAAU,EACxB,kBAAkB,sBAAqB,EAE1C,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACd,CAAG,CACH"}